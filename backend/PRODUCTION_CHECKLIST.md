# 一般公開前チェックリスト

## 必須対応（公開前に完了）

### 1. 認証の有効化 ✅ **完了**

**確認方法:**
```bash
flyctl secrets list --app live-schedule-api
```

**確認結果:**
- ✅ `DISABLE_AUTH`が設定されていない（認証は有効）
- ✅ `JWT_SECRET`が設定されている
- ✅ 認証ミドルウェアが実装されている

**詳細レポート:**
- `backend/AUTH_VERIFICATION_REPORT.md`を参照

**確認:**
- [x] `DISABLE_AUTH`が設定されていない
- [ ] ログイン機能が正常に動作する（動作テスト推奨）
- [ ] 未認証のリクエストが拒否される（動作テスト推奨）

---

### 2. 自動バックアップの設定 ✅/❌

**確認方法:**
- GitHub Actionsのワークフローが存在するか確認
- `.github/workflows/backup-db.yml`が存在する

**対応:**
1. GitHub Secretsに`FLY_API_TOKEN`を追加
```bash
# Fly.io APIトークンを取得
flyctl auth token

# GitHubリポジトリのSettings > Secrets > Actionsで追加
# 名前: FLY_API_TOKEN
# 値: <取得したトークン>
```

2. ワークフローの動作確認
- GitHub Actionsのページで手動実行
- バックアップが正常に作成されることを確認

**確認:**
- [ ] `.github/workflows/backup-db.yml`が存在する
- [ ] `FLY_API_TOKEN`がGitHub Secretsに設定されている
- [ ] 手動実行でバックアップが成功する
- [ ] バックアップファイルがアーティファクトとして保存される

---

### 3. ヘルスチェックエンドポイント ✅

**確認方法:**
```bash
curl https://live-schedule-api.fly.dev/health
```

**期待される応答:**
```
ok
```

**確認:**
- [ ] `/health`エンドポイントが応答する
- [ ] レスポンスが`ok`である

---

### 4. 環境変数の確認 ✅/❌

**必須環境変数:**
- `JWT_SECRET`: 強力なランダム値であること
- `DATABASE_URL`: 正しく設定されていること
- `BASE_URL`: 本番環境のURL
- `FRONTEND_URL`: フロントエンドのURL
- `ALLOWED_ORIGIN`: CORS設定

**確認方法:**
```bash
flyctl secrets list --app live-schedule-api
```

**確認:**
- [ ] すべての必須環境変数が設定されている
- [ ] `JWT_SECRET`が強力な値である（32文字以上推奨）
- [ ] `DISABLE_AUTH`が設定されていない

---

## 推奨対応（時間がある場合）

### 5. 監視の設定 ✅/❌

**無料オプション:**
- UptimeRobot（無料プラン）
  - URL: `https://live-schedule-api.fly.dev/health`
  - 監視間隔: 5分
  - アラート: メール通知

**確認:**
- [ ] 外部監視サービスが設定されている
- [ ] ダウンタイム時に通知が届く

---

### 6. ログの確認 ✅/❌

**確認方法:**
```bash
flyctl logs --app live-schedule-api
```

**確認:**
- [ ] エラーログがない
- [ ] 認証関連のログが正常
- [ ] データベース接続エラーがない

---

### 7. パフォーマンステスト ✅/❌

**確認項目:**
- レスポンスタイム: 1秒以内
- 同時接続: 10-50ユーザーで問題ないか
- データベースサイズ: 1GB以下

**確認方法:**
```bash
# レスポンスタイムの確認
time curl https://live-schedule-api.fly.dev/health

# データベースサイズの確認
flyctl sftp shell --app live-schedule-api
du -h /app/data/app.db
```

**確認:**
- [ ] レスポンスタイムが1秒以内
- [ ] データベースサイズが適切（1GB以下推奨）

---

## ドキュメント

### 8. 利用規約とプライバシーポリシー ✅/❌

**確認:**
- [ ] 利用規約が作成されている
- [ ] プライバシーポリシーが作成されている
- [ ] フロントエンドにリンクが設置されている

---

### 9. サポート連絡先 ✅/❌

**確認:**
- [ ] サポート用のメールアドレスが設定されている
- [ ] フロントエンドに連絡先が表示されている

---

## 最終確認

### 10. 総合テスト ✅/❌

**テスト項目:**
- [ ] ユーザー登録
- [ ] メール確認
- [ ] ログイン
- [ ] スケジュール作成・編集・削除
- [ ] 宿泊情報の登録
- [ ] 交通費の登録
- [ ] 共有機能
- [ ] パスワードリセット

---

## 公開後の監視

### 最初の1週間

- [ ] 毎日ログを確認
- [ ] エラーがないか確認
- [ ] パフォーマンスを確認
- [ ] バックアップが正常に実行されているか確認

### 定期的な確認（月次）

- [ ] バックアップの動作確認
- [ ] データベースサイズの確認
- [ ] コストの確認
- [ ] セキュリティアップデートの確認

---

## 緊急時の連絡先

- **Fly.ioサポート**: https://fly.io/docs/support/
- **GitHub Issues**: プロジェクトのIssuesページ

---

## 完了確認

すべての必須項目にチェックを入れたら、一般公開の準備が整っています。

**最終確認日**: _______________
**確認者**: _______________

